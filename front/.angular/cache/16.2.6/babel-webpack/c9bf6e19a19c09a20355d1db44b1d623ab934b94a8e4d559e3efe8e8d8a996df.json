{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Perovic/Desktop/PIA/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { lastValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../services/restoran.service\";\nconst _c0 = [\"canvas\"];\nexport class LayoutComponent {\n  constructor(http, restoranService) {\n    this.http = http;\n    this.restoranService = restoranService;\n    this.restoran = null;\n    this.zauzetiStolovi = [];\n    this.slobodniStolovi = [];\n    this.rezervacija = null;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        let rez = localStorage.getItem('rezervacija');\n        if (rez != null) _this.rezervacija = JSON.parse(rez);\n        let rezultat = yield lastValueFrom(_this.restoranService.getLayoutForRestoran(_this.rezervacija));\n        _this.restoran = rezultat.restoran;\n        _this.zauzetiStolovi = rezultat.zauzetiStolovi;\n        _this.slobodniStolovi = rezultat.slobodniStolovi;\n        console.log(_this.zauzetiStolovi);\n        console.log(_this.slobodniStolovi);\n        _this.ctx = _this.canvas.nativeElement.getContext('2d');\n        _this.drawLayout(_this.restoran, _this.slobodniStolovi, _this.zauzetiStolovi);\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }\n  drawLayout(restoran, slobodniStolovi, zauzetiStolovi) {\n    this.ctx.clearRect(0, 0, this.canvas.nativeElement.width, this.canvas.nativeElement.height);\n    let radius = 25;\n    slobodniStolovi.forEach(table => {\n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'white';\n      this.ctx.fill();\n      this.ctx.strokeStyle = 'black';\n      this.ctx.lineWidth = 2;\n      this.ctx.stroke();\n      this.ctx.closePath();\n      this.ctx.fillStyle = 'black';\n      this.ctx.textAlign = 'center';\n      this.ctx.textBaseline = 'middle';\n      this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n    zauzetiStolovi.forEach(table => {\n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'red';\n      this.ctx.fill();\n      this.ctx.strokeStyle = 'black';\n      this.ctx.lineWidth = 2;\n      this.ctx.stroke();\n      this.ctx.closePath();\n      this.ctx.fillStyle = 'black';\n      this.ctx.textAlign = 'center';\n      this.ctx.textBaseline = 'middle';\n      this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.kitchen.x, restoran.kitchen.y, 75, 200);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(restoran.kitchen.x, restoran.kitchen.y, 75, 200);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Kuhinja', restoran.kitchen.x + 5, restoran.kitchen.y + 5);\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.toilets.x, restoran.toilets.y, 75, 75);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(restoran.toilets.x, restoran.toilets.y, 75, 75);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Toalet', restoran.toilets.x + 5, restoran.toilets.y + 5);\n  }\n  static #_ = this.ɵfac = function LayoutComponent_Factory(t) {\n    return new (t || LayoutComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.RestoranService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LayoutComponent,\n    selectors: [[\"app-layout\"]],\n    viewQuery: function LayoutComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvas = _t.first);\n      }\n    },\n    inputs: {\n      layoutData: \"layoutData\"\n    },\n    decls: 3,\n    vars: 0,\n    consts: [[1, \"canvas-container\"], [\"width\", \"600\", \"height\", \"500\"], [\"canvas\", \"\"]],\n    template: function LayoutComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"canvas\", 1, 2);\n        i0.ɵɵelementEnd();\n      }\n    },\n    styles: [\".canvas-container[_ngcontent-%COMP%] {\\n    width: 600px; \\n    height: 500px; \\n    border: 2px solid black; \\n    display: inline-block; \\n}\\n\\ncanvas[_ngcontent-%COMP%] {\\n    display: block; \\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbGF5b3V0L2xheW91dC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksWUFBWTtJQUNaLGFBQWE7SUFDYix1QkFBdUI7SUFDdkIscUJBQXFCO0FBQ3pCOztBQUVBO0lBQ0ksY0FBYztBQUNsQiIsInNvdXJjZXNDb250ZW50IjpbIi5jYW52YXMtY29udGFpbmVyIHtcclxuICAgIHdpZHRoOiA2MDBweDsgXHJcbiAgICBoZWlnaHQ6IDUwMHB4OyBcclxuICAgIGJvcmRlcjogMnB4IHNvbGlkIGJsYWNrOyBcclxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgXHJcbn1cclxuXHJcbmNhbnZhcyB7XHJcbiAgICBkaXNwbGF5OiBibG9jazsgXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"names":["lastValueFrom","LayoutComponent","constructor","http","restoranService","restoran","zauzetiStolovi","slobodniStolovi","rezervacija","ngOnInit","_this","_asyncToGenerator","rez","localStorage","getItem","JSON","parse","rezultat","getLayoutForRestoran","console","log","ctx","canvas","nativeElement","getContext","drawLayout","error","clearRect","width","height","radius","forEach","table","centerX","x","centerY","y","beginPath","arc","Math","PI","fillStyle","fill","strokeStyle","lineWidth","stroke","closePath","textAlign","textBaseline","fillText","id","fillRect","kitchen","strokeRect","toilets","_","i0","ɵɵdirectiveInject","i1","HttpClient","i2","RestoranService","_2","selectors","viewQuery","LayoutComponent_Query","rf","ɵɵelementStart","ɵɵelement","ɵɵelementEnd"],"sources":["C:\\Users\\Perovic\\Desktop\\PIA\\front\\src\\app\\layout\\layout.component.ts","C:\\Users\\Perovic\\Desktop\\PIA\\front\\src\\app\\layout\\layout.component.html"],"sourcesContent":["import { Component, Input, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { LayoutResponse } from '../models/LayoutResponse';\nimport { HttpClient } from '@angular/common/http';\nimport { RestoranService } from '../services/restoran.service';\nimport { restoran } from '../models/restoran';\nimport { sto } from '../models/sto';\nimport { rezervacija } from '../models/rezervacija';\nimport { last, lastValueFrom } from 'rxjs';\n\n@Component({\n  selector: 'app-layout',\n  templateUrl: './layout.component.html',\n  styleUrls: ['./layout.component.css']\n})\nexport class LayoutComponent implements OnInit {\n  \n  @Input() layoutData: any; \n  @ViewChild('canvas', { static: true }) canvas: ElementRef<HTMLCanvasElement>;\n  private ctx: CanvasRenderingContext2D;\n  restoran: restoran = null;\n  zauzetiStolovi: sto[] = [];\n  slobodniStolovi: sto[] = [];\n  rezervacija: rezervacija = null;\n\n  constructor(private http: HttpClient, private restoranService: RestoranService) {}\n\n  \n  async ngOnInit(){\n    try{\n      let rez = localStorage.getItem('rezervacija')\n      if(rez != null) this.rezervacija = JSON.parse(rez);\n      let rezultat: any = await lastValueFrom(this.restoranService.getLayoutForRestoran(this.rezervacija))\n      this.restoran = rezultat.restoran;\n      this.zauzetiStolovi = rezultat.zauzetiStolovi;\n      this.slobodniStolovi = rezultat.slobodniStolovi;\n      console.log(this.zauzetiStolovi)\n      console.log(this.slobodniStolovi)\n      this.ctx  = this.canvas.nativeElement.getContext('2d');\n      this.drawLayout(this.restoran, this.slobodniStolovi, this.zauzetiStolovi);\n    } catch (error) {\n      console.log(error)\n    }\n  }\n\n  private drawLayout(restoran: restoran, slobodniStolovi: sto[], zauzetiStolovi: sto[]): void {\n    this.ctx.clearRect(0, 0, this.canvas.nativeElement.width, this.canvas.nativeElement.height);\n    let radius = 25;\n    slobodniStolovi.forEach(table => {\n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'white';\n      this.ctx.fill();\n      this.ctx.strokeStyle = 'black';\n      this.ctx.lineWidth = 2;\n      this.ctx.stroke();\n      this.ctx.closePath();\n\n      this.ctx.fillStyle = 'black';\n      this.ctx.textAlign = 'center';\n      this.ctx.textBaseline = 'middle';\n      this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n\n    zauzetiStolovi.forEach(table => {\n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'red';\n      this.ctx.fill();\n      this.ctx.strokeStyle = 'black';\n      this.ctx.lineWidth = 2;\n      this.ctx.stroke();\n      this.ctx.closePath();\n\n      this.ctx.fillStyle = 'black';\n      this.ctx.textAlign = 'center';\n      this.ctx.textBaseline = 'middle';\n      this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n\n\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.kitchen.x, restoran.kitchen.y, 75, 200);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(restoran.kitchen.x, restoran.kitchen.y, 75, 200);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Kuhinja', restoran.kitchen.x + 5, restoran.kitchen.y + 5);\n\n    \n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.toilets.x, restoran.toilets.y, 75, 75);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(restoran.toilets.x, restoran.toilets.y, 75, 75);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Toalet', restoran.toilets.x + 5, restoran.toilets.y + 5);\n  }\n}\n","<div class=\"canvas-container\">\n    <canvas #canvas width=\"600\" height=\"500\"></canvas>\n</div>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}