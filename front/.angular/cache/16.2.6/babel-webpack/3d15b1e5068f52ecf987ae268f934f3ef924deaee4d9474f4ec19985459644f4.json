{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Perovic/Desktop/PIA/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { lastValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../services/restoran.service\";\nimport * as i3 from \"../services/rezervacije.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nconst _c0 = [\"canvas\"];\nfunction LayoutComponent_section_5_option_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const sto_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", sto_r4.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"Sto: \", sto_r4.id, \", broj mesta za stolom: \", sto_r4.brojMesta, \"\");\n  }\n}\nfunction LayoutComponent_section_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"section\")(1, \"div\", 6)(2, \"h2\");\n    i0.ɵɵtext(3, \"Informacije o rezervaciji\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 7)(9, \"label\", 8);\n    i0.ɵɵtext(10, \"Odaberite sto:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"select\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function LayoutComponent_section_5_Template_select_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.selectedStoId = $event);\n    });\n    i0.ɵɵtemplate(12, LayoutComponent_section_5_option_12_Template, 2, 3, \"option\", 10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 11)(14, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function LayoutComponent_section_5_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.potvrdiRezervaciju());\n    });\n    i0.ɵɵtext(15, \"Potvrdi\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"span\", 13);\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"Gost: \", ctx_r1.rezervacija.gost, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Broj gostiju: \", ctx_r1.rezervacija.brojGostiju, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.selectedStoId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.odgovarajuciStolovi);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.message);\n  }\n}\nfunction LayoutComponent_section_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\")(1, \"div\", 6)(2, \"h2\", 15);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r2.success);\n  }\n}\nexport class LayoutComponent {\n  constructor(http, restoranService, rezervacijaService) {\n    this.http = http;\n    this.restoranService = restoranService;\n    this.rezervacijaService = rezervacijaService;\n    this.korisnik = null;\n    this.restoran = null;\n    this.zauzetiStolovi = [];\n    this.slobodniStolovi = [];\n    this.rezervacija = null;\n    this.odgovarajuciStolovi = [];\n    this.selectedStoId = -1;\n    this.message = \"\";\n    this.success = \"\";\n    this.flagCompleted = false;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        _this.flagCompleted = false;\n        _this.success = \"\";\n        _this.selectedStoId = -1;\n        _this.message = \"\";\n        let rez = localStorage.getItem('rezervacija');\n        if (rez != null) _this.rezervacija = JSON.parse(rez);\n        let kon = localStorage.getItem('ulogovan');\n        if (kon != null) _this.korisnik = JSON.parse(kon);\n        let rezultat = yield lastValueFrom(_this.restoranService.getLayoutForRestoran(_this.rezervacija));\n        _this.restoran = rezultat.restoran;\n        _this.zauzetiStolovi = rezultat.zauzetiStolovi;\n        _this.slobodniStolovi = rezultat.slobodniStolovi;\n        _this.slobodniStolovi.forEach(sto => {\n          if (sto.brojMesta >= _this.rezervacija.brojGostiju) {\n            _this.odgovarajuciStolovi.push(sto);\n          }\n        });\n        _this.ctx = _this.canvas.nativeElement.getContext('2d');\n        _this.drawLayout(_this.restoran, _this.slobodniStolovi, _this.zauzetiStolovi);\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }\n  drawLayout(restoran, slobodniStolovi, zauzetiStolovi) {\n    this.ctx.clearRect(0, 0, this.canvas.nativeElement.width, this.canvas.nativeElement.height);\n    const canvasWidth = this.canvas.nativeElement.width;\n    const canvasHeight = this.canvas.nativeElement.height;\n    const radius = 25;\n    const kitchenWidth = 75;\n    const kitchenHeight = 200;\n    const toiletWidth = 75;\n    const toiletHeight = 75;\n    // Trazimo da li postoji element van kanvasa tako sto nadjemo minimum i maksimum X i Y koordinate\n    let minX = Math.min(...slobodniStolovi.map(table => table.x), ...zauzetiStolovi.map(table => table.x), restoran.kitchen.x, restoran.toilets.x);\n    let minY = Math.min(...slobodniStolovi.map(table => table.y), ...zauzetiStolovi.map(table => table.y), restoran.kitchen.y, restoran.toilets.y);\n    let maxX = Math.max(...slobodniStolovi.map(table => table.x + radius * 2), ...zauzetiStolovi.map(table => table.x + radius * 2), restoran.kitchen.x + kitchenWidth, restoran.toilets.x + toiletWidth);\n    let maxY = Math.max(...slobodniStolovi.map(table => table.y + radius * 2), ...zauzetiStolovi.map(table => table.y + radius * 2), restoran.kitchen.y + kitchenHeight, restoran.toilets.y + toiletHeight);\n    let shiftX = 0;\n    let shiftY = 0;\n    if (minX < 0) {\n      // Ukoliko je minimum X van kanvasa, pomeramo ga za minX u desno\n      shiftX = -minX;\n    } else if (maxX > canvasWidth) {\n      // ukoliko je maximum X van kanvasa, pomeramo ga za razdaljinu ivice kanvasa do maximum X u levo\n      shiftX = canvasWidth - maxX;\n    }\n    if (minY < 0) {\n      // ukoliko je minimum Y van kanvasa, pomeramo ga za minY na gore\n      shiftY = -minY;\n    } else if (maxY > canvasHeight) {\n      // ukoliko je maximum Y van kanvasa, pomeramo ga za razdaljinu ivice kanvasa do maximum Y na dole\n      shiftY = canvasHeight - maxY;\n    }\n    const adjustPosition = (x, y) => {\n      return {\n        x: x + shiftX,\n        y: y + shiftY\n      };\n    };\n    slobodniStolovi.forEach(table => {\n      let {\n        x,\n        y\n      } = adjustPosition(table.x, table.y); // ako je potrebno podesavanje, pomerimo sve\n      const centerX = x + radius;\n      const centerY = y + radius;\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'white';\n      this.ctx.fill();\n      this.ctx.strokeStyle = 'black';\n      this.ctx.lineWidth = 2;\n      this.ctx.stroke();\n      this.ctx.closePath();\n      this.ctx.fillStyle = 'black';\n      this.ctx.textAlign = 'center';\n      this.ctx.textBaseline = 'middle';\n      this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n    zauzetiStolovi.forEach(table => {\n      let {\n        x,\n        y\n      } = adjustPosition(table.x, table.y); // ako je potrebno podesavanje, podesimo sve\n      const centerX = x + radius;\n      const centerY = y + radius;\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'red';\n      this.ctx.fill();\n      this.ctx.strokeStyle = 'black';\n      this.ctx.lineWidth = 2;\n      this.ctx.stroke();\n      this.ctx.closePath();\n      this.ctx.fillStyle = 'black';\n      this.ctx.textAlign = 'center';\n      this.ctx.textBaseline = 'middle';\n      this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n    let kitchenPos = adjustPosition(restoran.kitchen.x, restoran.kitchen.y); // ako je potrebno podesavanje, podesimo kuhinju\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(kitchenPos.x, kitchenPos.y, kitchenWidth, kitchenHeight);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(kitchenPos.x, kitchenPos.y, kitchenWidth, kitchenHeight);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Kuhinja', kitchenPos.x + 5, kitchenPos.y + 5);\n    let toiletPos = adjustPosition(restoran.toilets.x, restoran.toilets.y); // ako je potrebno podesavanje, podesimo toalet\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(toiletPos.x, toiletPos.y, toiletWidth, toiletHeight);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(toiletPos.x, toiletPos.y, toiletWidth, toiletHeight);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Toalet', toiletPos.x + 5, toiletPos.y + 5);\n  }\n  potvrdiRezervaciju() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this2.selectedStoId == -1) {\n          _this2.message = \"Niste odabrali sto!\";\n        } else {\n          _this2.message = \"\";\n          _this2.success = yield lastValueFrom(_this2.rezervacijaService.potvrdiRezervaciju(_this2.rezervacija.id, _this2.selectedStoId, _this2.korisnik.username));\n          let rezultat = yield lastValueFrom(_this2.restoranService.getLayoutForRestoran(_this2.rezervacija));\n          _this2.restoran = rezultat.restoran;\n          _this2.zauzetiStolovi = rezultat.zauzetiStolovi;\n          _this2.slobodniStolovi = rezultat.slobodniStolovi;\n          _this2.flagCompleted = true;\n          _this2.ctx = _this2.canvas.nativeElement.getContext('2d');\n          _this2.drawLayout(_this2.restoran, _this2.slobodniStolovi, _this2.zauzetiStolovi);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }\n  static #_ = this.ɵfac = function LayoutComponent_Factory(t) {\n    return new (t || LayoutComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.RestoranService), i0.ɵɵdirectiveInject(i3.RezervacijeService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LayoutComponent,\n    selectors: [[\"app-layout\"]],\n    viewQuery: function LayoutComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvas = _t.first);\n      }\n    },\n    inputs: {\n      layoutData: \"layoutData\"\n    },\n    decls: 7,\n    vars: 2,\n    consts: [[1, \"container\"], [1, \"layout-container\"], [1, \"canvas-container\"], [\"width\", \"600\", \"height\", \"500\"], [\"canvas\", \"\"], [4, \"ngIf\"], [1, \"reservation-form\"], [1, \"input-field\"], [\"for\", \"sto\"], [\"id\", \"sto\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"buttons\"], [3, \"click\"], [2, \"color\", \"red\"], [3, \"value\"], [2, \"color\", \"green\"]],\n    template: function LayoutComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2);\n        i0.ɵɵelement(3, \"canvas\", 3, 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(5, LayoutComponent_section_5_Template, 18, 5, \"section\", 5);\n        i0.ɵɵtemplate(6, LayoutComponent_section_6_Template, 4, 1, \"section\", 5);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.flagCompleted == false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.flagCompleted == true);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgModel],\n    styles: [\".canvas-container[_ngcontent-%COMP%] {\\n    width: 600px; \\n    height: 500px; \\n    border: 2px solid black; \\n    display: inline-block; \\n}\\n\\ncanvas[_ngcontent-%COMP%] {\\n    display: block; \\n}\\n\\nbody[_ngcontent-%COMP%] {\\n    font-family: Arial, sans-serif;\\n    background-color: #f4f4f4;\\n    margin: 0;\\n    padding: 0;\\n}\\n  \\n.container[_ngcontent-%COMP%] {\\n    width: 80%;\\n    margin: auto;\\n    overflow: hidden;\\n    background-color: #f7f7f7; \\n    padding: 20px; \\n    border-radius: 8px;\\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\\n}\\n  \\n.layout-container[_ngcontent-%COMP%] {\\n    display: flex;\\n    justify-content: space-between;\\n}\\n  \\n.canvas-container[_ngcontent-%COMP%] {\\n    flex: 2;\\n}\\n  \\n.reservation-form[_ngcontent-%COMP%] {\\n    flex: 1;\\n    margin-left: 20px;\\n    background-color: #fff;\\n    padding: 20px;\\n    border-radius: 8px;\\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\\n}\\n  \\n.reservation-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n    border-bottom: 2px solid #8561a8;\\n    padding-bottom: 5px;\\n    color: #8561a8;\\n}\\n  \\n.input-field[_ngcontent-%COMP%] {\\n    margin-bottom: 15px;\\n}\\n  \\n.input-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\\n    display: block;\\n    margin-bottom: 5px;\\n    font-weight: bold;\\n    color: #333;\\n}\\n  \\n.input-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {\\n    width: calc(100% - 10px);\\n    padding: 10px;\\n    border: 1px solid #ccc;\\n    border-radius: 4px;\\n    box-sizing: border-box;\\n}\\n  \\n.buttons[_ngcontent-%COMP%] {\\n    text-align: center;\\n    margin-top: 10px;\\n}\\n  \\n.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n    background: #8561a8;\\n    color: white;\\n    border: none;\\n    padding: 10px 20px;\\n    cursor: pointer;\\n    margin: 5px;\\n    border-radius: 4px; \\n}\\n  \\n.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover {\\n    background: #64427a; \\n}\\n  \\n@media only screen and (max-width: 768px) {\\n    .container[_ngcontent-%COMP%] {\\n      width: 90%;\\n    }\\n  \\n    .layout-container[_ngcontent-%COMP%] {\\n      flex-direction: column;\\n    }\\n  \\n    .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n      padding: 8px 16px;\\n    }\\n  \\n    .canvas-container[_ngcontent-%COMP%], .reservation-form[_ngcontent-%COMP%] {\\n      margin: 0;\\n    }\\n  \\n    .reservation-form[_ngcontent-%COMP%] {\\n      margin-top: 20px;\\n    }\\n}\\n  \\n@media only screen and (max-width: 576px) {\\n    .container[_ngcontent-%COMP%] {\\n      padding: 15px;\\n    }\\n  \\n    .buttons[_ngcontent-%COMP%] {\\n      display: flex;\\n      flex-wrap: wrap;\\n      justify-content: center;\\n    }\\n  \\n    .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n      margin: 5px;\\n    }\\n}\\n  \\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbGF5b3V0L2xheW91dC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksWUFBWTtJQUNaLGFBQWE7SUFDYix1QkFBdUI7SUFDdkIscUJBQXFCO0FBQ3pCOztBQUVBO0lBQ0ksY0FBYztBQUNsQjs7QUFFQTtJQUNJLDhCQUE4QjtJQUM5Qix5QkFBeUI7SUFDekIsU0FBUztJQUNULFVBQVU7QUFDZDs7QUFFQTtJQUNJLFVBQVU7SUFDVixZQUFZO0lBQ1osZ0JBQWdCO0lBQ2hCLHlCQUF5QjtJQUN6QixhQUFhO0lBQ2Isa0JBQWtCO0lBQ2xCLHVDQUF1QztBQUMzQzs7QUFFQTtJQUNJLGFBQWE7SUFDYiw4QkFBOEI7QUFDbEM7O0FBRUE7SUFDSSxPQUFPO0FBQ1g7O0FBRUE7SUFDSSxPQUFPO0lBQ1AsaUJBQWlCO0lBQ2pCLHNCQUFzQjtJQUN0QixhQUFhO0lBQ2Isa0JBQWtCO0lBQ2xCLHVDQUF1QztBQUMzQzs7QUFFQTtJQUNJLGdDQUFnQztJQUNoQyxtQkFBbUI7SUFDbkIsY0FBYztBQUNsQjs7QUFFQTtJQUNJLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLGNBQWM7SUFDZCxrQkFBa0I7SUFDbEIsaUJBQWlCO0lBQ2pCLFdBQVc7QUFDZjs7QUFFQTtJQUNJLHdCQUF3QjtJQUN4QixhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLGtCQUFrQjtJQUNsQixzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxrQkFBa0I7SUFDbEIsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksbUJBQW1CO0lBQ25CLFlBQVk7SUFDWixZQUFZO0lBQ1osa0JBQWtCO0lBQ2xCLGVBQWU7SUFDZixXQUFXO0lBQ1gsa0JBQWtCO0FBQ3RCOztBQUVBO0lBQ0ksbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0k7TUFDRSxVQUFVO0lBQ1o7O0lBRUE7TUFDRSxzQkFBc0I7SUFDeEI7O0lBRUE7TUFDRSxpQkFBaUI7SUFDbkI7O0lBRUE7O01BRUUsU0FBUztJQUNYOztJQUVBO01BQ0UsZ0JBQWdCO0lBQ2xCO0FBQ0o7O0FBRUE7SUFDSTtNQUNFLGFBQWE7SUFDZjs7SUFFQTtNQUNFLGFBQWE7TUFDYixlQUFlO01BQ2YsdUJBQXVCO0lBQ3pCOztJQUVBO01BQ0UsV0FBVztJQUNiO0FBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyIuY2FudmFzLWNvbnRhaW5lciB7XHJcbiAgICB3aWR0aDogNjAwcHg7IFxyXG4gICAgaGVpZ2h0OiA1MDBweDsgXHJcbiAgICBib3JkZXI6IDJweCBzb2xpZCBibGFjazsgXHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IFxyXG59XHJcblxyXG5jYW52YXMge1xyXG4gICAgZGlzcGxheTogYmxvY2s7IFxyXG59XHJcblxyXG5ib2R5IHtcclxuICAgIGZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICNmNGY0ZjQ7XHJcbiAgICBtYXJnaW46IDA7XHJcbiAgICBwYWRkaW5nOiAwO1xyXG59XHJcbiAgXHJcbi5jb250YWluZXIge1xyXG4gICAgd2lkdGg6IDgwJTtcclxuICAgIG1hcmdpbjogYXV0bztcclxuICAgIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjdmN2Y3OyBcclxuICAgIHBhZGRpbmc6IDIwcHg7IFxyXG4gICAgYm9yZGVyLXJhZGl1czogOHB4O1xyXG4gICAgYm94LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG59XHJcbiAgXHJcbi5sYXlvdXQtY29udGFpbmVyIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbn1cclxuICBcclxuLmNhbnZhcy1jb250YWluZXIge1xyXG4gICAgZmxleDogMjtcclxufVxyXG4gIFxyXG4ucmVzZXJ2YXRpb24tZm9ybSB7XHJcbiAgICBmbGV4OiAxO1xyXG4gICAgbWFyZ2luLWxlZnQ6IDIwcHg7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xyXG4gICAgcGFkZGluZzogMjBweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcclxuICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcclxufVxyXG4gIFxyXG4ucmVzZXJ2YXRpb24tZm9ybSBoMiB7XHJcbiAgICBib3JkZXItYm90dG9tOiAycHggc29saWQgIzg1NjFhODtcclxuICAgIHBhZGRpbmctYm90dG9tOiA1cHg7XHJcbiAgICBjb2xvcjogIzg1NjFhODtcclxufVxyXG4gIFxyXG4uaW5wdXQtZmllbGQge1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMTVweDtcclxufVxyXG4gIFxyXG4uaW5wdXQtZmllbGQgbGFiZWwge1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICBtYXJnaW4tYm90dG9tOiA1cHg7XHJcbiAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgIGNvbG9yOiAjMzMzO1xyXG59XHJcbiAgXHJcbi5pbnB1dC1maWVsZCBzZWxlY3Qge1xyXG4gICAgd2lkdGg6IGNhbGMoMTAwJSAtIDEwcHgpO1xyXG4gICAgcGFkZGluZzogMTBweDtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG59XHJcbiAgXHJcbi5idXR0b25zIHtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgIG1hcmdpbi10b3A6IDEwcHg7XHJcbn1cclxuICBcclxuLmJ1dHRvbnMgYnV0dG9uIHtcclxuICAgIGJhY2tncm91bmQ6ICM4NTYxYTg7XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbiAgICBib3JkZXI6IG5vbmU7XHJcbiAgICBwYWRkaW5nOiAxMHB4IDIwcHg7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgICBtYXJnaW46IDVweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDRweDsgXHJcbn1cclxuICBcclxuLmJ1dHRvbnMgYnV0dG9uOmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQ6ICM2NDQyN2E7IFxyXG59XHJcbiAgXHJcbkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1heC13aWR0aDogNzY4cHgpIHtcclxuICAgIC5jb250YWluZXIge1xyXG4gICAgICB3aWR0aDogOTAlO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLmxheW91dC1jb250YWluZXIge1xyXG4gICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLmJ1dHRvbnMgYnV0dG9uIHtcclxuICAgICAgcGFkZGluZzogOHB4IDE2cHg7XHJcbiAgICB9XHJcbiAgXHJcbiAgICAuY2FudmFzLWNvbnRhaW5lcixcclxuICAgIC5yZXNlcnZhdGlvbi1mb3JtIHtcclxuICAgICAgbWFyZ2luOiAwO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLnJlc2VydmF0aW9uLWZvcm0ge1xyXG4gICAgICBtYXJnaW4tdG9wOiAyMHB4O1xyXG4gICAgfVxyXG59XHJcbiAgXHJcbkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1heC13aWR0aDogNTc2cHgpIHtcclxuICAgIC5jb250YWluZXIge1xyXG4gICAgICBwYWRkaW5nOiAxNXB4O1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLmJ1dHRvbnMge1xyXG4gICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICBmbGV4LXdyYXA6IHdyYXA7XHJcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLmJ1dHRvbnMgYnV0dG9uIHtcclxuICAgICAgbWFyZ2luOiA1cHg7XHJcbiAgICB9XHJcbn1cclxuICAiXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"names":["lastValueFrom","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","sto_r4","id","ɵɵadvance","ɵɵtextInterpolate2","brojMesta","ɵɵlistener","LayoutComponent_section_5_Template_select_ngModelChange_11_listener","$event","ɵɵrestoreView","_r6","ctx_r5","ɵɵnextContext","ɵɵresetView","selectedStoId","ɵɵtemplate","LayoutComponent_section_5_option_12_Template","LayoutComponent_section_5_Template_button_click_14_listener","ctx_r7","potvrdiRezervaciju","ɵɵtextInterpolate1","ctx_r1","rezervacija","gost","brojGostiju","odgovarajuciStolovi","ɵɵtextInterpolate","message","ctx_r2","success","LayoutComponent","constructor","http","restoranService","rezervacijaService","korisnik","restoran","zauzetiStolovi","slobodniStolovi","flagCompleted","ngOnInit","_this","_asyncToGenerator","rez","localStorage","getItem","JSON","parse","kon","rezultat","getLayoutForRestoran","forEach","sto","push","ctx","canvas","nativeElement","getContext","drawLayout","error","console","log","clearRect","width","height","canvasWidth","canvasHeight","radius","kitchenWidth","kitchenHeight","toiletWidth","toiletHeight","minX","Math","min","map","table","x","kitchen","toilets","minY","y","maxX","max","maxY","shiftX","shiftY","adjustPosition","centerX","centerY","beginPath","arc","PI","fillStyle","fill","strokeStyle","lineWidth","stroke","closePath","textAlign","textBaseline","fillText","kitchenPos","fillRect","strokeRect","toiletPos","_this2","username","_","ɵɵdirectiveInject","i1","HttpClient","i2","RestoranService","i3","RezervacijeService","_2","selectors","viewQuery","LayoutComponent_Query","rf","ɵɵelement","LayoutComponent_section_5_Template","LayoutComponent_section_6_Template"],"sources":["C:\\Users\\Perovic\\Desktop\\PIA\\front\\src\\app\\layout\\layout.component.ts","C:\\Users\\Perovic\\Desktop\\PIA\\front\\src\\app\\layout\\layout.component.html"],"sourcesContent":["import { Component, Input, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { LayoutResponse } from '../models/LayoutResponse';\nimport { HttpClient } from '@angular/common/http';\nimport { RestoranService } from '../services/restoran.service';\nimport { restoran } from '../models/restoran';\nimport { sto } from '../models/sto';\nimport { rezervacija } from '../models/rezervacija';\nimport { last, lastValueFrom } from 'rxjs';\nimport { RezervacijeService } from '../services/rezervacije.service';\nimport { konobar } from '../models/konobar';\n\n@Component({\n  selector: 'app-layout',\n  templateUrl: './layout.component.html',\n  styleUrls: ['./layout.component.css']\n})\nexport class LayoutComponent implements OnInit {\n  \n  @Input() layoutData: any; \n  @ViewChild('canvas', { static: true }) canvas: ElementRef<HTMLCanvasElement>;\n  private ctx: CanvasRenderingContext2D;\n  korisnik: konobar = null;\n  restoran: restoran = null;\n  zauzetiStolovi: sto[] = [];\n  slobodniStolovi: sto[] = [];\n  rezervacija: rezervacija = null;\n  odgovarajuciStolovi: sto[] = [];\n  selectedStoId: number = -1;\n  message: string = \"\";\n  success: string = \"\";\n  flagCompleted: boolean = false;\n  constructor(private http: HttpClient, private restoranService: RestoranService, private rezervacijaService: RezervacijeService) {}\n\n  \n  async ngOnInit(){\n    try{\n      this.flagCompleted = false;\n      this.success = \"\";\n      this.selectedStoId = -1;\n      this.message = \"\";\n      let rez = localStorage.getItem('rezervacija')\n      if(rez != null) this.rezervacija = JSON.parse(rez);\n      let kon = localStorage.getItem('ulogovan');\n      if(kon != null) this.korisnik = JSON.parse(kon);\n      let rezultat: any = await lastValueFrom(this.restoranService.getLayoutForRestoran(this.rezervacija))\n      this.restoran = rezultat.restoran;\n      this.zauzetiStolovi = rezultat.zauzetiStolovi;\n      this.slobodniStolovi = rezultat.slobodniStolovi;\n      this.slobodniStolovi.forEach(sto=>{\n        if(sto.brojMesta >= this.rezervacija.brojGostiju){\n          this.odgovarajuciStolovi.push(sto);\n        }\n      })\n      this.ctx  = this.canvas.nativeElement.getContext('2d');\n      this.drawLayout(this.restoran, this.slobodniStolovi, this.zauzetiStolovi);\n    } catch (error) {\n      console.log(error)\n    }\n  }\n\n  private drawLayout(restoran: restoran, slobodniStolovi: sto[], zauzetiStolovi: sto[]): void {\n    this.ctx.clearRect(0, 0, this.canvas.nativeElement.width, this.canvas.nativeElement.height);\n\n    const canvasWidth = this.canvas.nativeElement.width;\n    const canvasHeight = this.canvas.nativeElement.height;\n    const radius = 25;\n    const kitchenWidth = 75;\n    const kitchenHeight = 200;\n    const toiletWidth = 75;\n    const toiletHeight = 75;\n    // Trazimo da li postoji element van kanvasa tako sto nadjemo minimum i maksimum X i Y koordinate\n    let minX = Math.min( \n        ...slobodniStolovi.map(table => table.x),\n        ...zauzetiStolovi.map(table => table.x),\n        restoran.kitchen.x,\n        restoran.toilets.x\n    );\n    let minY = Math.min(\n        ...slobodniStolovi.map(table => table.y),\n        ...zauzetiStolovi.map(table => table.y),\n        restoran.kitchen.y,\n        restoran.toilets.y\n    );\n    let maxX = Math.max(\n        ...slobodniStolovi.map(table => table.x + radius * 2),\n        ...zauzetiStolovi.map(table => table.x + radius * 2),\n        restoran.kitchen.x + kitchenWidth,\n        restoran.toilets.x + toiletWidth\n    );\n    let maxY = Math.max(\n        ...slobodniStolovi.map(table => table.y + radius * 2),\n        ...zauzetiStolovi.map(table => table.y + radius * 2),\n        restoran.kitchen.y + kitchenHeight,\n        restoran.toilets.y + toiletHeight\n    );\n\n\n    let shiftX = 0;\n    let shiftY = 0;\n\n    if (minX < 0) { // Ukoliko je minimum X van kanvasa, pomeramo ga za minX u desno\n        shiftX = -minX;\n    } else if (maxX > canvasWidth) { // ukoliko je maximum X van kanvasa, pomeramo ga za razdaljinu ivice kanvasa do maximum X u levo\n        shiftX = canvasWidth - maxX;\n    }\n\n    if (minY < 0) { // ukoliko je minimum Y van kanvasa, pomeramo ga za minY na gore\n        shiftY = -minY; \n    } else if (maxY > canvasHeight) { // ukoliko je maximum Y van kanvasa, pomeramo ga za razdaljinu ivice kanvasa do maximum Y na dole\n        shiftY = canvasHeight - maxY;\n    }\n\n    const adjustPosition = (x: number, y: number) => { // funkcija za podesavanje koordinata\n        return { x: x + shiftX, y: y + shiftY };\n    };\n\n    slobodniStolovi.forEach(table => {\n        let { x, y } = adjustPosition(table.x, table.y); // ako je potrebno podesavanje, pomerimo sve\n        const centerX = x + radius;\n        const centerY = y + radius;\n\n        this.ctx.beginPath();\n        this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n        this.ctx.fillStyle = 'white';\n        this.ctx.fill();\n        this.ctx.strokeStyle = 'black';\n        this.ctx.lineWidth = 2;\n        this.ctx.stroke();\n        this.ctx.closePath();\n\n        this.ctx.fillStyle = 'black';\n        this.ctx.textAlign = 'center';\n        this.ctx.textBaseline = 'middle';\n        this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n\n    zauzetiStolovi.forEach(table => {\n        let { x, y } = adjustPosition(table.x, table.y); // ako je potrebno podesavanje, podesimo sve\n        const centerX = x + radius;\n        const centerY = y + radius;\n\n        this.ctx.beginPath();\n        this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n        this.ctx.fillStyle = 'red';\n        this.ctx.fill();\n        this.ctx.strokeStyle = 'black';\n        this.ctx.lineWidth = 2;\n        this.ctx.stroke();\n        this.ctx.closePath();\n\n        this.ctx.fillStyle = 'black';\n        this.ctx.textAlign = 'center';\n        this.ctx.textBaseline = 'middle';\n        this.ctx.fillText(`Table ${table.id}`, centerX, centerY);\n    });\n\n    let kitchenPos = adjustPosition(restoran.kitchen.x, restoran.kitchen.y); // ako je potrebno podesavanje, podesimo kuhinju\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(kitchenPos.x, kitchenPos.y, kitchenWidth, kitchenHeight);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(kitchenPos.x, kitchenPos.y, kitchenWidth, kitchenHeight);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Kuhinja', kitchenPos.x + 5, kitchenPos.y + 5);\n\n    let toiletPos = adjustPosition(restoran.toilets.x, restoran.toilets.y); // ako je potrebno podesavanje, podesimo toalet\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(toiletPos.x, toiletPos.y, toiletWidth, toiletHeight);\n    this.ctx.strokeStyle = 'black';\n    this.ctx.lineWidth = 2;\n    this.ctx.strokeRect(toiletPos.x, toiletPos.y, toiletWidth, toiletHeight);\n    this.ctx.fillStyle = 'black';\n    this.ctx.textAlign = 'start';\n    this.ctx.textBaseline = 'top';\n    this.ctx.fillText('Toalet', toiletPos.x + 5, toiletPos.y + 5);\n  }\n\n  async potvrdiRezervaciju(){\n    try{\n      if(this.selectedStoId == -1) {\n        this.message = \"Niste odabrali sto!\";\n      } else {\n        this.message = \"\";\n        this.success = await lastValueFrom(this.rezervacijaService.potvrdiRezervaciju(this.rezervacija.id, this.selectedStoId, this.korisnik.username));\n        let rezultat: any = await lastValueFrom(this.restoranService.getLayoutForRestoran(this.rezervacija))\n        this.restoran = rezultat.restoran;\n        this.zauzetiStolovi = rezultat.zauzetiStolovi;\n        this.slobodniStolovi = rezultat.slobodniStolovi;\n        this.flagCompleted = true;\n        this.ctx  = this.canvas.nativeElement.getContext('2d');\n        this.drawLayout(this.restoran, this.slobodniStolovi, this.zauzetiStolovi); \n      }\n    } catch (error){\n      console.log(error);\n    }\n  }\n}\n","<div class=\"container\">\n    <div class=\"layout-container\">\n      <div class=\"canvas-container\">\n        <canvas #canvas width=\"600\" height=\"500\"></canvas>\n      </div>\n      <section *ngIf=\"flagCompleted == false\">\n        <div class=\"reservation-form\">\n            <h2>Informacije o rezervaciji</h2>\n            <p>Gost: {{rezervacija.gost}}</p>\n            <p>Broj gostiju: {{rezervacija.brojGostiju}}</p>\n            <div class=\"input-field\">\n            <label for=\"sto\">Odaberite sto:</label>\n            <select id=\"sto\" [(ngModel)]=\"selectedStoId\">\n                <option *ngFor=\"let sto of odgovarajuciStolovi\" [value]=\"sto.id\">Sto: {{sto.id}}, broj mesta za stolom: {{sto.brojMesta}}</option>\n            </select>\n            </div>\n            <div class=\"buttons\">\n            <button (click)=\"potvrdiRezervaciju()\">Potvrdi</button>\n            <span style=\"color: red;\">{{message}}</span>\n            </div>\n        </div>\n      </section>\n      <section *ngIf=\"flagCompleted == true\">\n        <div class=\"reservation-form\">\n            <h2 style=\"color: green;\">{{success}}</h2>\n        </div>\n      </section>\n    </div>\n</div>\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}