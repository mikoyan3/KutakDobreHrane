{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Perovic/Desktop/PIA/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { lastValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../services/restoran.service\";\nconst _c0 = [\"canvas\"];\nexport class LayoutComponent {\n  constructor(http, restoranService) {\n    this.http = http;\n    this.restoranService = restoranService;\n    this.restoran = null;\n    this.zauzetiStolovi = [];\n    this.slobodniStolovi = [];\n    this.rezervacija = null;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        let rez = localStorage.getItem('rezervacija');\n        if (rez != null) _this.rezervacija = JSON.parse(rez);\n        let rezultat = yield lastValueFrom(_this.restoranService.getLayoutForRestoran(_this.rezervacija));\n        _this.restoran = rezultat.restoran;\n        _this.zauzetiStolovi = rezultat.zauzetiStolovi;\n        _this.slobodniStolovi = rezultat.slobodniStolovi;\n        _this.ctx = _this.canvas.nativeElement.getContext('2d');\n        _this.drawLayout(_this.restoran, _this.slobodniStolovi, _this.zauzetiStolovi);\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }\n  drawLayout(restoran, slobodniStolovi, zauzetiStolovi) {\n    this.ctx.clearRect(0, 0, this.canvas.nativeElement.width, this.canvas.nativeElement.height);\n    slobodniStolovi.forEach(table => {\n      const radius = 25;\n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'black';\n      this.ctx.fill();\n      this.ctx.closePath();\n      this.ctx.fillStyle = 'white';\n      this.ctx.fillText(`Table ${table.id}`, centerX - 15, centerY);\n    });\n    zauzetiStolovi.forEach(table => {\n      const radius = 25;\n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'black';\n      this.ctx.fill();\n      this.ctx.closePath();\n      this.ctx.fillStyle = 'red';\n      this.ctx.fillText(`Table ${table.id}`, centerX - 15, centerY);\n    });\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.kitchen.x, restoran.kitchen.y, 75, 200);\n    this.ctx.fillStyle = 'black';\n    this.ctx.fillText('Kuhinja', restoran.kitchen.x, restoran.kitchen.y);\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.toilets.x, restoran.toilets.y, 75, 75);\n    this.ctx.fillStyle = 'black';\n    this.ctx.fillText('Toalet', restoran.toilets.x, restoran.toilets.y);\n  }\n  static #_ = this.ɵfac = function LayoutComponent_Factory(t) {\n    return new (t || LayoutComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.RestoranService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LayoutComponent,\n    selectors: [[\"app-layout\"]],\n    viewQuery: function LayoutComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvas = _t.first);\n      }\n    },\n    inputs: {\n      layoutData: \"layoutData\"\n    },\n    decls: 3,\n    vars: 0,\n    consts: [[1, \"canvas-container\"], [\"width\", \"600\", \"height\", \"500\"], [\"canvas\", \"\"]],\n    template: function LayoutComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"canvas\", 1, 2);\n        i0.ɵɵelementEnd();\n      }\n    },\n    styles: [\".canvas-container[_ngcontent-%COMP%] {\\n    width: 600px; \\n    height: 500px; \\n    border: 2px solid black; \\n    display: inline-block; \\n}\\n\\ncanvas[_ngcontent-%COMP%] {\\n    display: block; \\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbGF5b3V0L2xheW91dC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksWUFBWTtJQUNaLGFBQWE7SUFDYix1QkFBdUI7SUFDdkIscUJBQXFCO0FBQ3pCOztBQUVBO0lBQ0ksY0FBYztBQUNsQiIsInNvdXJjZXNDb250ZW50IjpbIi5jYW52YXMtY29udGFpbmVyIHtcclxuICAgIHdpZHRoOiA2MDBweDsgXHJcbiAgICBoZWlnaHQ6IDUwMHB4OyBcclxuICAgIGJvcmRlcjogMnB4IHNvbGlkIGJsYWNrOyBcclxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgXHJcbn1cclxuXHJcbmNhbnZhcyB7XHJcbiAgICBkaXNwbGF5OiBibG9jazsgXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"names":["lastValueFrom","LayoutComponent","constructor","http","restoranService","restoran","zauzetiStolovi","slobodniStolovi","rezervacija","ngOnInit","_this","_asyncToGenerator","rez","localStorage","getItem","JSON","parse","rezultat","getLayoutForRestoran","ctx","canvas","nativeElement","getContext","drawLayout","error","console","log","clearRect","width","height","forEach","table","radius","centerX","x","centerY","y","beginPath","arc","Math","PI","fillStyle","fill","closePath","fillText","id","fillRect","kitchen","toilets","_","i0","ɵɵdirectiveInject","i1","HttpClient","i2","RestoranService","_2","selectors","viewQuery","LayoutComponent_Query","rf","ɵɵelementStart","ɵɵelement","ɵɵelementEnd"],"sources":["C:\\Users\\Perovic\\Desktop\\PIA\\front\\src\\app\\layout\\layout.component.ts","C:\\Users\\Perovic\\Desktop\\PIA\\front\\src\\app\\layout\\layout.component.html"],"sourcesContent":["import { Component, Input, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { LayoutResponse } from '../models/LayoutResponse';\nimport { HttpClient } from '@angular/common/http';\nimport { RestoranService } from '../services/restoran.service';\nimport { restoran } from '../models/restoran';\nimport { sto } from '../models/sto';\nimport { rezervacija } from '../models/rezervacija';\nimport { last, lastValueFrom } from 'rxjs';\n\n@Component({\n  selector: 'app-layout',\n  templateUrl: './layout.component.html',\n  styleUrls: ['./layout.component.css']\n})\nexport class LayoutComponent implements OnInit {\n  \n  @Input() layoutData: any; \n  @ViewChild('canvas', { static: true }) canvas: ElementRef<HTMLCanvasElement>;\n  private ctx: CanvasRenderingContext2D;\n  restoran: restoran = null;\n  zauzetiStolovi: sto[] = [];\n  slobodniStolovi: sto[] = [];\n  rezervacija: rezervacija = null;\n\n  constructor(private http: HttpClient, private restoranService: RestoranService) {}\n\n  \n  async ngOnInit(){\n    try{\n      let rez = localStorage.getItem('rezervacija')\n      if(rez != null) this.rezervacija = JSON.parse(rez);\n      let rezultat: any = await lastValueFrom(this.restoranService.getLayoutForRestoran(this.rezervacija))\n      this.restoran = rezultat.restoran;\n      this.zauzetiStolovi = rezultat.zauzetiStolovi;\n      this.slobodniStolovi = rezultat.slobodniStolovi;\n      this.ctx  = this.canvas.nativeElement.getContext('2d');\n      this.drawLayout(this.restoran, this.slobodniStolovi, this.zauzetiStolovi);\n    } catch (error) {\n      console.log(error)\n    }\n  }\n\n  private drawLayout(restoran: restoran, slobodniStolovi: sto[], zauzetiStolovi: sto[]): void {\n    this.ctx.clearRect(0, 0, this.canvas.nativeElement.width, this.canvas.nativeElement.height);\n\n    slobodniStolovi.forEach(table => {\n      const radius = 25; \n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n  \n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'black';\n      this.ctx.fill();\n      this.ctx.closePath();\n  \n      this.ctx.fillStyle = 'white';\n      this.ctx.fillText(`Table ${table.id}`, centerX - 15, centerY);\n    });\n\n    zauzetiStolovi.forEach(table => {\n      const radius = 25; \n      const centerX = table.x + radius;\n      const centerY = table.y + radius;\n  \n      this.ctx.beginPath();\n      this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n      this.ctx.fillStyle = 'black';\n      this.ctx.fill();\n      this.ctx.closePath();\n  \n      this.ctx.fillStyle = 'red';\n      this.ctx.fillText(`Table ${table.id}`, centerX - 15, centerY);\n    });\n\n\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.kitchen.x, restoran.kitchen.y, 75, 200);\n    this.ctx.fillStyle = 'black';\n    this.ctx.fillText('Kuhinja', restoran.kitchen.x, restoran.kitchen.y);\n\n    this.ctx.fillStyle = 'white';\n    this.ctx.fillRect(restoran.toilets.x, restoran.toilets.y, 75, 75);\n    this.ctx.fillStyle = 'black';\n    this.ctx.fillText('Toalet', restoran.toilets.x, restoran.toilets.y);\n  }\n}\n","<div class=\"canvas-container\">\n    <canvas #canvas width=\"600\" height=\"500\"></canvas>\n</div>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}